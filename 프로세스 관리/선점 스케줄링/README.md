# 선점 스케줄링

선점 스케줄링에 해당하는 선점 우선순위, SRT, RR, 다단계 큐, 다단계 피드백 큐 알고리즘에 대해 알아보자

## 1. 선점 우선순위

- 준비상태 큐의 프로세스들 중에서 우선순위가 가장 높은 프로세스에게 먼저 CPU를 할당하는 기법이다.
- 비선점 우선순위 기법을 선점 형태로 변경한 것으로, 준비상태 큐에 새로 들어온 프로세스의 순위가 높을 경우 현재의 프로세스를 보류하고 새로운 프로세스를 실행한다.

## 2. SRT (Shortest Remaining Time)

- 비선점 스케줄링인 SJF 기법을 선점 형태로 변경한 기법으로, 선점 SJF 기법이라고도 한다.
- 현재 실행중인 프로세스의 남은 시간과 준비상태 큐에 새로 도착한 프로세스의 실행 시간을 비교하여 가장 짧은 실행 시간을 요구하는 프로세스에게 CPU를 할당하는 기법으로, 시분할 시스템에 유용하다.
- 준비상태 큐에 있는 각 프로세스의 실행 시간을 추적하여 보유하고 있어야 하므로 오버헤드가 증가한다.

## 3. RR (Round Robin)

- 시분할 시스템(Time Sharing System)을 위해 고안된 방식으로, FCFS(FIFO) 알고리즘을 선점 형태로 변형한 기법이다.
- FCFS 기법과 같이 준비상태 큐에 먼저 들어온 프로세스가 먼저 CPU를 할당받지만 각 프로세스는 시간 할당량(Time Slice, Quantum ) 동안만 실행한 후 실행이 완료되지 않으면 다음 프로세스에게 CPU를 넘겨주고 준비상태 큐의 가장 뒤로 배치된다.
- 할당되는 시간이 클 경우 FCFS 기법과 같아지고, 할당되는 시간이 작을 경우 문맥 교환 및 오버헤드가 자주 발생되어 요청된 작업을 신속히 처리할 수 없다.
- 할당되는 시간의 크기가 작으면 작은 프로세스들에게 유리하다.

### 예제 다음과 같은 프로세스들이 차례로 준비상태 큐에 들어왔다고 가정할 때, 평균 대기 시간, 평균 반환 시간을 구하시오 ( 단, Time Slice는 4초이다. )

| 프로세스 번호 | P1  | P2  | P3  |
| ------------- | --- | --- | --- |
| 실행 시간     | 20  | 4   | 6   |

1. 주어진 시간 할당량(Time Slice) 동안 실행되지 못할 경우 준비상태 큐의 가장 마지막으로 재배치하여 차례를 기다리므로 다음과 같이 표시할 수 있다.

| 진행 시간     | 0   | 4   | 8         | 12  | 16  | 18        | 22  | 26  | 30        |
| ------------- | --- | --- | --------- | --- | --- | --------- | --- | --- | --------- |
| 프로세스 번호 | P1  | P1  | P2 (완료) | P3  | P1  | P3 (완료) | P1  | P1  | P1 (완료) |
| 실행 시간     | 0   | 4   | 4         | 4   | 4   | 2         | 4   | 4   | 4         |

2. 반환 시간 : 각 프로세스가 완료되는 시간을 이용하여 구한다.
3. 대기 시간 : 대기 시간을 구하고자 하는 프로세스의 가장 마지막 실행이 시작되기 전까지의 진행 시간을 이용하여 구하되, 해당 프로세스가 앞에서 실행되었을 경우 실행된 시간은 제외한다.

| 프로세스 번호 | P1           | P2  | P3          | 평균          |
| ------------- | ------------ | --- | ----------- | ------------- |
| 반환 시간     | 30           | 8   | 18          | 56 / 3 = 18.6 |
| 대기 시간     | 26 - 16 = 10 | 4   | 16 - 4 = 12 | 26 / 3 = 8.6  |

## 4. 다단계 큐(MQ; Multi-level Queue )

- 프로세스를 특정 그룹으로 분류할 수 있을 경우 그룹에 따라 각기 다른 준비상태 큐를 사용하는 기법이다.
- 일반적으로 프로세스 우선순위에 따라 시스템 프로세스, 대화형 프로세스, 편집 프로세스, 일괄 처리 프로세스 등으로 나누어 준비상태 큐를 상위, 중위, 하위 단계로 배치한다.
- 각 준비상태 큐는 독자적인 스케줄링을 가지고 있으므로 각 그룹의 특성에 따라 서로 다른 스케줄링 기법을 사용할 수 있다.
- 프로세스가 특정 그룹의 준비상태 큐에 들어갈 경우 다른 준비상태 큐로 이동할 수 없다.
- 하위 단계 준비상태 큐에 있는 프로세스를 실행하는 도중이라도 상위 단계 준비상태 큐에 프로세스가 들어오면 상위 단계 프로세스에게 CPU를 할당해야 한다.

## 5. 다단계 피드백 큐(MFQ; Multi-level Feedback Queue)

- 특정 그룹의 준비상태 큐에 들어간 프로세스가 다른 준비상태 큐로 이동할 수 없는 다단계 큐 기법을 준비상태 큐 사이를 이동할 수 있도록 개선한 기법이다.
- 적응 기법(Adaptive Mechanism)의 개념을 적용했다.
- 각 준비상태 큐마다 시간 할당량을 부여하여 그 시간 동안 완료하지 못한 프로세스는 다음 단계의 준비상태 큐로 이동된다.
- 상위 단계 준비상태 큐일수록 우선순위가 높고, 시간 할당량이 적다.
- 요구하는 시간이 적은 프로세스, 입 출력 중심의 프로세스, 낮은 우선순위에서 너무 오래 기다린 프로세스를 기준으로 높은 우선순위를 할당한다.
- 하위 단계 준비상태 큐에 있는 프로세스를 실행하는 도중이라도 상위 단게 준비상태 큐에 프로세스가 들어오면 상위 단계 프로세스에게 CPU를 할당하며, 마지막 단계 큐에서는 작업이 완료될 때까지 RR 스케줄링 기법을 사용한다.
